import numpy as np

from numpy import sqrt

from numpy import exp

from numpy import pi

from scipy.special import erf


def hessian2(x, y, x0, y0, z0, sigma, N0, eta, texp, gain, var):
    h_xx = N0*eta*gain*texp*(0.125*sqrt(2)*(-2*x + 2*x0 - 1.0)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**3) - 0.125*sqrt(2)*(-2*x + 2*x0 + 1.0)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**3))*(-erf(sqrt(2)*(y - y0 - 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))) + erf(sqrt(2)*(y - y0 + 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))))
    h_xy = N0*eta*gain*texp*(-sqrt(2)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)) + sqrt(2)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)))*(-0.25*sqrt(2)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)) + 0.25*sqrt(2)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)))
    h_xz = N0*eta*gain*texp*(-0.25*sqrt(2)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)) + 0.25*sqrt(2)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)))*(-sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 - 0.5)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) + sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 + 0.5)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2)) + N0*eta*gain*texp*(-erf(sqrt(2)*(y - y0 - 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))) + erf(sqrt(2)*(y - y0 + 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))))*(-0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) + 0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) - 0.125*sqrt(2)*(-2.1396556e-6*z0 - 0.0008852632475996)*(x - x0 - 0.5)**2*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**4) + 0.125*sqrt(2)*(-2.1396556e-6*z0 - 0.0008852632475996)*(x - x0 + 0.5)**2*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**4))
    h_xN = eta*gain*texp*(-0.25*sqrt(2)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)) + 0.25*sqrt(2)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)))*(-erf(sqrt(2)*(y - y0 - 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))) + erf(sqrt(2)*(y - y0 + 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))))
    h_yx = N0*eta*gain*texp*(-sqrt(2)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)) + sqrt(2)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)))*(-0.25*sqrt(2)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)) + 0.25*sqrt(2)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)))
    h_yy = N0*eta*gain*texp*(sqrt(2)*(-2*y + 2*y0 - 1.0)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(2*sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**3) - sqrt(2)*(-2*y + 2*y0 + 1.0)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(2*sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**3))*(-0.25*erf(sqrt(2)*(x - x0 - 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))) + 0.25*erf(sqrt(2)*(x - x0 + 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))))
    h_yz = N0*eta*gain*texp*(-sqrt(2)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)) + sqrt(2)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)))*(-0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 - 0.5)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) + 0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 + 0.5)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2)) + N0*eta*gain*texp*(-0.25*erf(sqrt(2)*(x - x0 - 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))) + 0.25*erf(sqrt(2)*(x - x0 + 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))))*(-sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) + sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) - sqrt(2)*(-2.4066812e-6*z0 + 0.0009957426863692)*(y - y0 - 0.5)**2*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(2*sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**4) + sqrt(2)*(-2.4066812e-6*z0 + 0.0009957426863692)*(y - y0 + 0.5)**2*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(2*sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**4))
    h_yN = eta*gain*texp*(-sqrt(2)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)) + sqrt(2)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)))*(-0.25*erf(sqrt(2)*(x - x0 - 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))) + 0.25*erf(sqrt(2)*(x - x0 + 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))))
    h_zx = N0*eta*gain*texp*(-0.25*sqrt(2)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)) + 0.25*sqrt(2)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)))*(-sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 - 0.5)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) + sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 + 0.5)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2)) + N0*eta*gain*texp*(-erf(sqrt(2)*(y - y0 - 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))) + erf(sqrt(2)*(y - y0 + 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))))*(-0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) + 0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) - 0.125*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(-2*x + 2*x0 - 1.0)*(x - x0 + 0.5)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**4) + 0.125*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(-2*x + 2*x0 + 1.0)*(x - x0 - 0.5)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**4))
    h_zy = N0*eta*gain*texp*(-sqrt(2)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)) + sqrt(2)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)))*(-0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 - 0.5)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) + 0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 + 0.5)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2)) + N0*eta*gain*texp*(-0.25*erf(sqrt(2)*(x - x0 - 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))) + 0.25*erf(sqrt(2)*(x - x0 + 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))))*(-sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) + sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) - sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(-2*y + 2*y0 - 1.0)*(y - y0 + 0.5)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(2*sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**4) + sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(-2*y + 2*y0 + 1.0)*(y - y0 - 0.5)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(2*sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**4))
    h_zz = 2*N0*eta*gain*texp*(-sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 - 0.5)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) + sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 + 0.5)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))*(-0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 - 0.5)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) + 0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 + 0.5)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2)) + N0*eta*gain*texp*(-erf(sqrt(2)*(y - y0 - 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))) + erf(sqrt(2)*(y - y0 + 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))))*(2.6745695e-7*sqrt(2)*(x - x0 - 0.5)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) - 2.6745695e-7*sqrt(2)*(x - x0 + 0.5)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) - 0.25*sqrt(2)*(-2.1396556e-6*z0 - 0.0008852632475996)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 - 0.5)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**3) + 0.25*sqrt(2)*(-2.1396556e-6*z0 - 0.0008852632475996)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 + 0.5)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**3) + 0.125*sqrt(2)*(-2.1396556e-6*z0 - 0.0008852632475996)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 - 0.5)**3*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**5) - 0.125*sqrt(2)*(-2.1396556e-6*z0 - 0.0008852632475996)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 + 0.5)**3*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**5)) + N0*eta*gain*texp*(-0.25*erf(sqrt(2)*(x - x0 - 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))) + 0.25*erf(sqrt(2)*(x - x0 + 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))))*(1.2033406e-6*sqrt(2)*(y - y0 - 0.5)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) - 1.2033406e-6*sqrt(2)*(y - y0 + 0.5)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) - sqrt(2)*(-2.4066812e-6*z0 + 0.0009957426863692)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 - 0.5)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**3) + sqrt(2)*(-2.4066812e-6*z0 + 0.0009957426863692)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 + 0.5)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**3) + sqrt(2)*(-2.4066812e-6*z0 + 0.0009957426863692)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 - 0.5)**3*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(2*sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**5) - sqrt(2)*(-2.4066812e-6*z0 + 0.0009957426863692)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 + 0.5)**3*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(2*sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**5))
    h_zN = eta*gain*texp*(-sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 - 0.5)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) + sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 + 0.5)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))*(-0.25*erf(sqrt(2)*(x - x0 - 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))) + 0.25*erf(sqrt(2)*(x - x0 + 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)))) + eta*gain*texp*(-0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 - 0.5)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) + 0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 + 0.5)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))*(-erf(sqrt(2)*(y - y0 - 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))) + erf(sqrt(2)*(y - y0 + 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))))
    h_Nx = eta*gain*texp*(-0.25*sqrt(2)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)) + 0.25*sqrt(2)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)))*(-erf(sqrt(2)*(y - y0 - 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))) + erf(sqrt(2)*(y - y0 + 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))))
    h_Ny = eta*gain*texp*(-sqrt(2)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)) + sqrt(2)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)))*(-0.25*erf(sqrt(2)*(x - x0 - 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))) + 0.25*erf(sqrt(2)*(x - x0 + 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))))
    h_Nz = eta*gain*texp*(-sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 - 0.5)*exp(-(y - y0 - 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2) + sqrt(2)*(-1.2033406e-6*z0 + 0.0004978713431846)*(y - y0 + 0.5)*exp(-(y - y0 + 0.5)**2/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))/(sqrt(pi)*(sigma + 6.016703e-7*(z0 - 413.741)**2)**2))*(-0.25*erf(sqrt(2)*(x - x0 - 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2))) + 0.25*erf(sqrt(2)*(x - x0 + 0.5)/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)))) + eta*gain*texp*(-0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 - 0.5)*exp(-(x - x0 - 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2) + 0.25*sqrt(2)*(-1.0698278e-6*z0 - 0.0004426316237998)*(x - x0 + 0.5)*exp(-(x - x0 + 0.5)**2/(2*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))/(sqrt(pi)*(sigma + 5.349139e-7*(z0 + 413.741)**2)**2))*(-erf(sqrt(2)*(y - y0 - 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))) + erf(sqrt(2)*(y - y0 + 0.5)/(2*(sigma + 6.016703e-7*(z0 - 413.741)**2))))
    h_NN = np.zeros_like(h_xx)
    H = np.array([[h_xx,h_xy,h_xz,h_xN], [h_yx,h_yy,h_yz,h_yN], [h_zx,h_zy,h_zz,h_zN],[h_Nx,h_Ny,h_Nz,h_NN]], dtype=np.float64)
    return H
